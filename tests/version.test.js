// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Zora from "@dusty-phillips/rescript-zora/src/Zora.js";
import Dexie from "dexie";
import * as DexieVersion from "../src/DexieVersion.js";
import FDBFactoryJs from "fake-indexeddb/lib/FDBFactory.js";
import FDBKeyRangeJs from "fake-indexeddb/lib/FDBKeyRange.js";

function $$default(t) {
  t.test("Initialize version and upgrade", (function (t) {
          var idb = new FDBFactoryJs();
          var dexie = new Dexie("hello dexie", {
                indexedDB: idb,
                IDBKeyRange: FDBKeyRangeJs
              });
          var schema = [
            [
              "friends",
              "++id,name,birthdate,sex"
            ],
            [
              "pets",
              "++id,name,kind"
            ]
          ];
          DexieVersion.upgrade(DexieVersion.stores(dexie.version(1), schema), (function (_tx) {
                  
                }));
          dexie.open();
          var friends = dexie.table("friends");
          t.equal(friends.name, "friends", "Table name should be `friends`");
          t.ok(true, "It is fine");
          return friends.add({
                            id: undefined,
                            name: "Chris",
                            sex: "Nonbinary"
                          }).then(function (id) {
                          t.equal(id, 1, "Id should be 1");
                          return Zora.done(undefined);
                        }).then(function (param) {
                        return friends.get(1);
                      }).then(function (result) {
                      t.equal(result.name, "Chris", "Returned friend should have same name");
                      t.equal(result.sex, "Nonbinary", "Returned friend should have same name");
                      return Zora.done(undefined);
                    });
        }));
  
}

export {
  $$default ,
  $$default as default,
  
}
/* dexie Not a pure module */
